#!/bin/bash
# 0 A.D. latest version available
cd /home/fusion809/GitHub/others/0ad

while ! `ping -q -w 1 -c 1 $(ip r | grep default | cut -d ' ' -f 3) > /dev/null`
do
    sleep 60
done

# update repository
if `which git > /dev/null 2>&1`; then
    git pull origin master -q
else
    printf "git isn't found. Please install it, or if it is installed edit your system PATH.\n" && exit
fi

# Determine latest commit's number
orlv=$(git rev-list --branches master --count)
# 0 A.D. latest packaged version
orpv=$(cat /data/OBS/home:fusion809/0ad/0ad.spec | grep "Version:" | sed 's/Version:\s*//g')

if [[ $orpv == $orlv ]]; then
    printf "0 A.D.ï…¤ \n"
else
    printf "0 A.D.${orlv}\n"
fi
